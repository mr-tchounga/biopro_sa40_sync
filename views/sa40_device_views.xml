<odoo>
  <!-- Devices tree -->
  <record id="view_sa40_device_tree" model="ir.ui.view">
    <field name="name">sa40.device.tree</field>
    <field name="model">sa40.device</field>
    <field name="arch" type="xml">
      <tree>
        <field name="name"/>
        <field name="device_ip"/>
        <field name="device_timeout"/>
        <field name="active"/>
      </tree>
    </field>
  </record>

  <!-- Devices form with header buttons -->
  <record id="view_sa40_device_form" model="ir.ui.view">
    <field name="name">sa40.device.form</field>
    <field name="model">sa40.device</field>
    <field name="arch" type="xml">
      <form string="SA40 Device">
        <header>
          <!-- Visible, high-priority actions -->
          <button name="test_connectivity" type="object" string="Test Connection" class="oe_highlight"/>
          <button name="fetch_users_from_device" type="object" string="Fetch Users"/>
          <button name="sync_data" type="object" string="Sync (persist)" attrs="{'invisible': [('active','=', False)]}"/>
        </header>

        <sheet>
          <group>
            <group>
              <field name="name"/>
              <field name="device_ip"/>
              <field name="active"/>
            </group>
            <group>
              <field name="device_timeout"/>
              <field name="device_password" password="True"/>
            </group>
          </group>

          <group col="6" class="mt-2 mt-md-0">
            <note colspan="6">
              <label for="note"/>
              <field name="note" invisible="1"/>
              <div>
                Use <b>Test Connection</b> to verify device reachability.<br/>
                Use <b>Fetch Users</b> to import device users (create/update).<br/>
                Use <b>Sync (persist)</b> to fetch and persist attendance logs.
              </div>
            </note>
          </group>
        </sheet>

        <footer>
          <button string="Fetch Users" type="object" name="fetch_users_from_device" class="btn-primary"
                  attrs="{'invisible': [('active','=', False)]}"/>
          <button string="Sync (persist)" type="object" name="sync_data" class="btn-primary"
                  attrs="{'invisible': [('active','=', False)]}"/>
          <button string="Close" class="btn-default" special="cancel"/>
        </footer>
      </form>
    </field>
  </record>

  <!-- window action for devices -->
  <record id="action_sa40_device_tree" model="ir.actions.act_window">
    <field name="name">SA40 Devices</field>
    <field name="res_model">sa40.device</field>
    <field name="view_mode">tree,form</field>
    <field name="view_id" ref="view_sa40_device_tree"/>
  </record>

  <!-- top-level menu & devices menu -->
  <menuitem id="menu_sa40_root" name="SA40 Sync"/>
  <menuitem id="menu_sa40_devices" name="Devices" parent="menu_sa40_root" action="action_sa40_device_tree"/>

</odoo>
